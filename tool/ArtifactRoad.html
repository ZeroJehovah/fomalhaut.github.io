<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <base href="https://zerojehovah.github.io/"/>

    <script>
        let imagePath = [
            "resource\\img\\road-a.jpg",
            "resource\\img\\road-b.jpg"
        ];

        //在本地存储中保存图片
        var storageFiles = JSON.parse(localStorage.getItem("storageFiles")) || {},
            elephant = document.getElementById("elephant"),
            storageFilesDate = storageFiles.date,
            date = new Date(),
            todaysDate = (date.getMonth() + 1).toString() + date.getDate().toString();
        // 检查数据，如果不存在或者数据过期，则创建一个本地存储
        if (typeof storageFilesDate === "undefined" || storageFilesDate < todaysDate) {
            // 图片加载完成后执行
            elephant.addEventListener("load", function () {
                var imgCanvas = document.createElement("canvas"),
                    imgContext = imgCanvas.getContext("2d");
                // 确保canvas尺寸和图片一致
                imgCanvas.width = elephant.width;
                imgCanvas.height = elephant.height;
                // 在canvas中绘制图片
                imgContext.drawImage(elephant, 0, 0, elephant.width, elephant.height);
                // 将图片保存为Data URI
                storageFiles.elephant = imgCanvas.toDataURL("image/png");
                storageFiles.date = todaysDate;
                // 将JSON保存到本地存储中
                try {
                    localStorage.setItem("storageFiles", JSON.stringify(storageFiles));
                } catch (e) {
                    console.log("Storage failed: " + e);
                }
            }, false);
            // 设置图片
            elephant.setAttribute("src", "elephant.png");
        } else {
            // Use image from localStorage
            elephant.setAttribute("src", storageFiles.elephant);
        }
    </script>

    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="author" content="IceRovah, icerovah@gmail.com"/>

    <title>圣遗物路线</title>
    <link rel="shortcut icon" type="image/ico" href="resource/icon/favicon.ico"/>
    <link rel="bookmark" href="resource/icon/favicon.ico"/>
</head>
<body>
<figure>
    <img id="elephant" src="about:blank" alt="A close up of an elephant">
    <noscript>
        <img src="elephant.png" alt="A close up of an elephant">
    </noscript>
    <figcaption>A mighty big elephant, and mighty close too!</figcaption>
</figure>
</body>
</html>